<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Tri?t h?c Mác–Lênin</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Merriweather:wght@700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #ffffff;
      --muted: #6b7280;
      --primary: #111827;
      --accent: #c41e3a;
    }
    body {
      margin: 0; padding: 20px;
      font-family: 'Inter', system-ui;
      background: #f5f6f7; color: var(--primary);
    }
    .app {
      display: grid;
      grid-template-columns: 350px 1fr;
      max-width: 1300px;
      margin: auto;
      background: white;
      border-radius: 14px;
      box-shadow: 0 6px 24px rgba(0,0,0,0.08);
      overflow: hidden;
    }
    @media(max-width:900px){ .app{grid-template-columns:1fr;} }

    .left { padding:20px; border-right:1px solid #eee; }
    .topic {
      background:#f9fafb;
      border-left:4px solid var(--accent);
      padding:10px;
      border-radius:8px;
      margin:10px 0;
      cursor:pointer;
    }
    .topic:hover { background:#fff3f3; }

    .right { padding:20px; display:flex; flex-direction:column; }

    .view {
      flex:1; overflow:auto;
      padding:10px;
      border:1px solid #eee;
      border-radius:10px;
      background:#fff;
    }
    .msg { margin:10px 0; display:flex; }
    .msg.user { justify-content:flex-end; }
    .msg.ai { justify-content:flex-start; }

    .bubble {
      padding:12px 14px;
      border-radius:12px;
      max-width:80%;
      line-height:1.5;
    }
    .msg.user .bubble {
      background: #fef2f2;
      color: #111;
      border:1px solid #f5c2c2;
    }
    .msg.ai .bubble {
      background:#f9fafb;
      border:1px solid #e5e7eb;
      color:#111;
    }

    textarea {
      flex:1; border:1px solid #ddd;
      border-radius:10px; padding:10px;
      resize:none; font-family:inherit;
    }
    button {
      background: var(--accent); color: white;
      border:none; border-radius:10px;
      padding:10px 16px; cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="left">
      <h2 style="color:#c41e3a;font-family:Merriweather;">Tri?t h?c Mác–Lênin</h2>
      <p>Ch?n ch? ð? ho?c ð?t câu h?i b?t k? ð? AI phân tích theo phong cách h?c thu?t.</p>
      <div id="topics"></div>
    </div>
    <div class="right">
      <div class="view" id="view">
        <div class="msg ai"><div class="bubble">Xin chào! Tôi là AI Tri?t h?c. B?n có th? h?i v? giá tr? th?ng dý, tích l?y tý b?n, h?nh th?c bi?u hi?n ho?c liên h? Vi?t Nam.</div></div>
      </div>
      <div style="margin-top:10px;display:flex;gap:10px;">
        <textarea id="user-input" placeholder="Nh?p câu h?i c?a b?n..."></textarea>
        <button id="send">G?i</button>
      </div>
    </div>
  </div>

<script>
const OPENAI_API_KEY = const OPENAI_API_KEY = import.meta.env.VITE_OPENAI_API_KEY;

const KNOWLEDGE_BASE = {

  "3.1": {
    title: "3.1 L? lu?n c?a C. Mác v? giá tr? th?ng dý",
    text: `
<strong>?? Khái ni?m:</strong><br>
Giá tr? th?ng dý (GTTD) là ph?n giá tr? m?i mà ngý?i lao ð?ng t?o ra vý?t quá giá tr? s?c lao ð?ng c?a h? — ph?n này b? nhà tý b?n chi?m ðo?t không tr? công.<br><br>

<strong>?? C?u trúc giá tr? hàng hoá:</strong><br>
Theo C.Mác, giá tr? hàng hóa ðý?c c?u thành b?i:<br>
<em>Giá tr? hàng hoá (W) = c + v + m</em><br>
• <strong>c</strong> – tý b?n b?t bi?n (constant capital): giá tr? tý li?u s?n xu?t ðý?c chuy?n nguyên v?n vào s?n ph?m.<br>
• <strong>v</strong> – tý b?n kh? bi?n (variable capital): giá tr? s?c lao ð?ng, tr? dý?i d?ng ti?n lýõng.<br>
• <strong>m</strong> – giá tr? th?ng dý (surplus value): ph?n giá tr? m?i do lao ð?ng t?o ra vý?t trên v.<br><br>

<strong>?? Quá tr?nh s?n xu?t GTTD:</strong><br>
Trong s?n xu?t tý b?n ch? ngh?a, lao ð?ng c?a công nhân chia thành:<br>
• <em>Th?i gian lao ð?ng t?t y?u (t?):</em> t?o ra giá tr? týõng ðýõng ti?n lýõng (v).<br>
• <em>Th?i gian lao ð?ng th?ng dý (t?):</em> t?o ra giá tr? th?ng dý (m).<br>
? Công th?c cõ b?n: <strong>m = t? / t? × v</strong><br>
? T? su?t giá tr? th?ng dý: <strong>m’ = m / v × 100%</strong><br><br>

<strong>?? B?n ch?t:</strong><br>
• GTTD không ph?i do tý b?n sinh ra, mà do lao ð?ng s?ng t?o ra.<br>
• Lao ð?ng là hàng hoá ð?c bi?t: giá tr? s? d?ng c?a nó t?o ra giá tr? m?i l?n hõn giá tr? c?a b?n thân nó.<br><br>

<strong>?? ? ngh?a:</strong><br>
• Là “h?n ðá t?ng” c?a h?c thuy?t kinh t? chính tr? Mác.<br>
• V?ch tr?n b?n ch?t bóc l?t h?p pháp trong quan h? s?n xu?t tý b?n ch? ngh?a.<br>
• Là cõ s? khoa h?c cho ð?u tranh giai c?p và l? lu?n v? ch? ngh?a x? h?i.`
  },

  "3.1.3": {
    title: "3.1.3 Các phýõng pháp s?n xu?t giá tr? th?ng dý",
    text: `
<strong>?? 1. Giá tr? th?ng dý tuy?t ð?i:</strong><br>
Thu ðý?c b?ng cách kéo dài ngày lao ð?ng vý?t quá th?i gian lao ð?ng t?t y?u (t?).<br>
• Ngày lao ð?ng = t? + t?<br>
• Khi kéo dài t? ? m?, m’? (t? su?t GTTD tãng).<br>
Ví d?: Lao ð?ng 8h ? 10h/ngày, n?u 4h ð?u là t? th? t? tãng t? 4h ? 6h ? m’ = 6/4 × 100% = 150%.<br>
<em>Gi?i h?n:</em> B? ràng bu?c b?i s?c kh?e, ði?u ki?n x? h?i, lu?t lao ð?ng.<br><br>

<strong>?? 2. Giá tr? th?ng dý týõng ð?i:</strong><br>
Thu ðý?c b?ng cách rút ng?n th?i gian lao ð?ng t?t y?u (t?), trong khi t?ng th?i gian lao ð?ng không ð?i.<br>
• Cõ ch?: tãng nãng su?t lao ð?ng x? h?i ? h? giá tr? tý li?u sinh ho?t ? gi?m giá tr? s?c lao ð?ng.<br>
• K?t qu?: t? gi?m, t? tãng ? m’?.<br>
Ví d?: Ngày lao ð?ng 8h, t? gi?m t? 4h ? 3h ? t? tãng t? 4h ? 5h ? m’ = 5/3 × 100% ? 166%.<br><br>

<strong>?? 3. Giá tr? th?ng dý siêu ng?ch:</strong><br>
Do doanh nghi?p cá bi?t có nãng su?t lao ð?ng cao hõn m?c x? h?i trung b?nh.<br>
• <em>Ði?u ki?n:</em> Giá tr? cá bi?t (w?) < Giá tr? x? h?i (w?).<br>
• GTTD siêu ng?ch = w? – w?.<br>
Ví d?: S?n xu?t 1 s?n ph?m có giá tr? x? h?i 100, nhýng doanh nghi?p cá bi?t ch? c?n 80 ? GTTD siêu ng?ch = 20.<br><br>

<strong>?? ? ngh?a:</strong><br>
Ba phýõng pháp ð?u là cách th?c tý b?n gia tãng bóc l?t lao ð?ng, nhýng GTTD týõng ð?i và siêu ng?ch là ð?ng l?c m?nh nh?t thúc ð?y ti?n b? k? thu?t và c?nh tranh trong TBCN.`
  },

  "3.2": {
    title: "3.2 Tích l?y tý b?n",
    text: `
<strong>?? Khái ni?m:</strong><br>
Tích l?y tý b?n là quá tr?nh chuy?n hoá m?t ph?n giá tr? th?ng dý (m) thành tý b?n m?i (?C), nh?m m? r?ng quy mô s?n xu?t.<br>
<em>Bi?u th?c:</em> TB' = c + v + m ? TB'' = c + ?c + v + ?v<br><br>

<strong>?? Quy mô tích l?y ph? thu?c:</strong><br>
1. T? su?t giá tr? th?ng dý (m’) – càng cao, tích l?y càng l?n.<br>
2. Nãng su?t lao ð?ng x? h?i – càng cao, chi phí s?n xu?t càng gi?m.<br>
3. Chênh l?ch gi?a tý b?n b?t bi?n và kh? bi?n (c/v).<br><br>

<strong>?? H? qu?:</strong><br>
• C?u t?o h?u cõ tý b?n tãng: c/v ? ? máy móc thay th? lao ð?ng s?ng.<br>
• Tích t? tý b?n (m?t doanh nghi?p ngày càng l?n) và t?p trung tý b?n (nhi?u tý b?n nh? h?p nh?t).<br>
• Phân hoá x? h?i: m?t c?c tích l?y tài s?n, m?t c?c tích l?y nghèo ðói.<br>
• H?nh thành “quân d? b? công nghi?p” – l?c lý?ng lao ð?ng th?t nghi?p thý?ng tr?c.<br><br>

<strong>?? Công th?c Mác mô t?:</strong><br>
?C = m × a<br>
? Trong ðó <em>a</em> là t? l? tái ð?u tý c?a giá tr? th?ng dý.<br>
N?u m = 100, a = 0.6 ? ?C = 60 ? 60% giá tr? th?ng dý dùng ð? m? r?ng s?n xu?t.<br><br>

<strong>?? ? ngh?a:</strong><br>
Tích l?y tý b?n ph?n ánh ð?ng l?c n?i t?i c?a TBCN, ð?ng th?i c?ng là nguyên nhân sâu xa c?a b?t b?nh ð?ng x? h?i.`
  },

  "3.3": {
    title: "3.3 Các h?nh th?c bi?u hi?n c?a giá tr? th?ng dý",
    text: `
<strong>?? 1. L?i nhu?n (p):</strong><br>
<em>Công th?c:</em> p = G – k = m<br>
• Chi phí s?n xu?t (k) = c + v.<br>
• T? su?t l?i nhu?n: p’ = p / (c + v) × 100%.<br>
• L?i nhu?n b?nh quân (P): h?nh thành qua c?nh tranh gi?a các ngành, d?n ð?n <em>t? su?t l?i nhu?n b?nh quân</em>.<br><br>

<strong>?? 2. L?i t?c (Z):</strong><br>
Ph?n l?i nhu?n b?nh quân tr? cho ngý?i cho vay v?n.<br>
• T? su?t l?i t?c: Z’ = Z / (TBCV) × 100%.<br>
? L?i t?c ph?n ánh s? phân chia GTTD gi?a nhà tý b?n công nghi?p và tý b?n cho vay.<br><br>

<strong>?? 3. Ð?a tô tý b?n ch? ngh?a:</strong><br>
Ph?n l?i nhu?n siêu ng?ch c?n l?i sau khi tr? l?i nhu?n b?nh quân cho ð?a ch?.<br>
• <em>Ð?a tô chênh l?ch I:</em> do khác bi?t t? nhiên v? ð? màu m?, v? trí ð?t.<br>
• <em>Ð?a tô chênh l?ch II:</em> do ð?u tý thâm canh tãng nãng su?t.<br>
• <em>Ð?a tô tuy?t ð?i:</em> do ch? ð? tý h?u ru?ng ð?t t?o ra.<br><br>

<strong>?? 4. Bi?u hi?n hi?n ð?i:</strong><br>
Trong th?i ð?i k? thu?t s?, giá tr? th?ng dý bi?u hi?n dý?i h?nh th?c:<br>
• “Data rent”: giá tr? thu ðý?c t? d? li?u ngý?i dùng (Facebook, Google).<br>
• “Platform rent”: ph?n trãm hoa h?ng các n?n t?ng nhý Uber, AppStore.<br>
• “Algorithm rent”: l?i ích t? thu?t toán ð?c quy?n (AI, big data).<br><br>

<strong>?? ? ngh?a:</strong><br>
Các h?nh th?c l?i nhu?n – l?i t?c – ð?a tô che gi?u ngu?n g?c lao ð?ng c?a GTTD, làm cho bóc l?t tr? nên “vô h?nh” nhýng sâu s?c hõn.`
  },

  "vietnam": {
    title: "Th?c ti?n t?i Vi?t Nam qua lãng kính Mác – Lênin",
    text: `
<strong>?? 1. GTTD trong doanh nghi?p FDI:</strong><br>
Công nhân Samsung, Foxconn, PouYuen làm 8h/ngày, lýõng ~8–10 tri?u/tháng, nhýng t?o ra s?n ph?m tr? giá hàng trãm tri?u ð?ng.<br>
? Ph?n chênh l?ch ðó chính là giá tr? th?ng dý b? chi?m ðo?t.<br><br>

<strong>?? 2. Tích l?y tý b?n ? Vi?t Nam:</strong><br>
• Tích l?y ch? y?u thông qua tái ð?u tý FDI: hõn 70% l?i nhu?n ðý?c tái ð?u tý.<br>
• C?u t?o h?u cõ tãng nhanh trong các ngành công nghi?p – máy móc thay th? lao ð?ng ph? thông.<br>
• H? qu?: b?t b?nh ð?ng thu nh?p, chênh l?ch vùng mi?n, h?nh thành t?ng l?p “tý s?n m?i”.<br><br>

<strong>?? 3. H?nh th?c bi?u hi?n m?i:</strong><br>
• L?i nhu?n siêu ng?ch trong ngành công ngh? (FPT, VNG, VinFast).<br>
• “Ð?a tô k? thu?t s?” thông qua d? li?u ngý?i dùng và b?n quy?n ph?n m?m.<br>
• Tích t? tý b?n trong b?t ð?ng s?n, tài chính, n?n t?ng s?.<br><br>

<strong>?? 4. Ð?nh hý?ng kh?c ph?c:</strong><br>
• Nâng cao giá tr? s?c lao ð?ng: tãng lýõng t?i thi?u, phát tri?n công ðoàn ð?c l?p.<br>
• Nhà ný?c ði?u ti?t b?ng thu? l?y ti?n, chính sách phúc l?i x? h?i.<br>
• Hý?ng t?i n?n kinh t? th? trý?ng <em>ð?nh hý?ng x? h?i ch? ngh?a</em>, b?o ð?m hài h?a gi?a tãng trý?ng và công b?ng.`
  }

};


function appendMessage(role, text){
  const wrap = document.createElement('div');
  wrap.className = 'msg ' + role;
  const b = document.createElement('div');
  b.className = 'bubble';
  b.innerHTML = text;
  wrap.appendChild(b);
  document.getElementById('view').appendChild(wrap);
  document.getElementById('view').scrollTop = 9999;
}

async function handleQuestion(q){
  if(!q.trim()) return;
  appendMessage('user', q);
  document.getElementById('user-input').value = '';

  const lower = q.toLowerCase();
  let kbKey = null;
  if(lower.includes('giá tr? th?ng dý')) kbKey = "3.1";
  else if(lower.includes('phýõng pháp')) kbKey = "3.1.3";
  else if(lower.includes('tích l?y')) kbKey = "3.2";
  else if(lower.includes('h?nh th?c')) kbKey = "3.3";
  else if(lower.includes('vi?t nam')) kbKey = "vietnam";

  if(kbKey){
    appendMessage('ai', `<strong>${KNOWLEDGE_BASE[kbKey].title}</strong><br>${KNOWLEDGE_BASE[kbKey].text}`);
  } else {
    appendMessage('ai', "Ðang phân tích sâu...");
    try {
      const resp = await fetch("https://api.openai.com/v1/chat/completions", {
        method:"POST",
        headers:{
          "Content-Type":"application/json",
          "Authorization":"Bearer " + OPENAI_API_KEY
        },
        body: JSON.stringify({
          model:"gpt-4o-mini",
          messages:[
            {role:"system", content:"B?n là tr? l? tri?t h?c Mác–Lênin, tr? l?i ti?ng Vi?t, phong cách h?c thu?t sâu, bi?n ch?ng, có ví d? và k?t lu?n."},
            {role:"user", content:q}
          ]
        })
      });
      const data = await resp.json();
      const msg = data?.choices?.[0]?.message?.content || "Không có ph?n h?i t? API.";
      appendMessage('ai', msg.replace(/\n/g,'<br>'));
    } catch(e){
      appendMessage('ai', "? L?i khi g?i OpenAI API: " + e.message);
    }
  }
}

document.getElementById('send').addEventListener('click',()=>handleQuestion(document.getElementById('user-input').value));
document.getElementById('user-input').addEventListener('keypress',e=>{
  if(e.key==='Enter' && !e.shiftKey){e.preventDefault();handleQuestion(e.target.value);}
});

// render topics
const topicsEl = document.getElementById('topics');
Object.values(KNOWLEDGE_BASE).forEach(k=>{
  const d=document.createElement('div');
  d.className='topic';
  d.innerHTML=`<strong>${k.title}</strong><br><span style="font-size:13px">${k.text.slice(0,80)}...</span>`;
  d.onclick=()=>handleQuestion(k.title);
  topicsEl.appendChild(d);
});
</script>
</body>
</html>
