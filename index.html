<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Tri·∫øt h·ªçc M√°c‚ÄìL√™nin</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Merriweather:wght@700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent: #c41e3a;
      --bg: #ffffff;
      --text: #111111;
      --muted: #6b7280;
    }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: "Inter", system-ui;
      padding: 20px;
    }
    .app {
      display: grid;
      grid-template-columns: 340px 1fr;
      max-width: 1300px;
      margin: auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      overflow: hidden;
    }
    @media(max-width: 900px) { .app { grid-template-columns: 1fr; } }

    .left {
      border-right: 1px solid #eee;
      padding: 20px;
      background: #fafafa;
    }
    .left h2 {
      font-family: "Merriweather", serif;
      color: var(--accent);
    }
    .topic {
      background: #fff;
      border-left: 4px solid var(--accent);
      padding: 10px 12px;
      margin: 8px 0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .topic:hover {
      background: #fff3f3;
      transform: scale(1.01);
    }

    .right {
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    .view {
      flex: 1;
      overflow-y: auto;
      border: 1px solid #eee;
      border-radius: 10px;
      padding: 12px;
      background: #fff;
    }
    .msg {
      margin: 10px 0;
      display: flex;
    }
    .msg.user {
      justify-content: flex-end;
    }
    .msg.ai {
      justify-content: flex-start;
    }
    .bubble {
      padding: 12px 14px;
      border-radius: 12px;
      line-height: 1.6;
      max-width: 80%;
      white-space: pre-line;
      font-size: 15px;
    }
    .msg.user .bubble {
      background: #fef2f2;
      border: 1px solid #f5c2c2;
      color: #111;
    }
    .msg.ai .bubble {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      color: #111;
    }
    .input-row {
      display: flex;
      gap: 10px;
      margin-top: 12px;
    }
    textarea {
      flex: 1;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px;
      resize: none;
      font-family: inherit;
      font-size: 15px;
    }
    button {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 10px;
      padding: 10px 16px;
      cursor: pointer;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="left">
      <h2>Tri·∫øt h·ªçc M√°c‚ÄìL√™nin</h2>
      <p style="font-size:14px;color:#555;">Ch·ªçn ch·ªß ƒë·ªÅ ho·∫∑c ƒë·∫∑t c√¢u h·ªèi b·∫•t k·ª≥ ƒë·ªÉ AI ph√¢n t√≠ch theo phong c√°ch h·ªçc thu·∫≠t, bi·ªán ch·ª©ng.</p>
      <div id="topics"></div>
    </div>

    <div class="right">
      <div class="view" id="view">
        <div class="msg ai">
          <div class="bubble">Xin ch√†o! üëã T√¥i l√† AI Tri·∫øt h·ªçc M√°c‚ÄìL√™nin. B·∫°n c√≥ th·ªÉ h·ªèi t√¥i v·ªÅ gi√° tr·ªã th·∫∑ng d∆∞, t√≠ch l≈©y t∆∞ b·∫£n, h√¨nh th·ª©c bi·ªÉu hi·ªán ho·∫∑c th·ª±c ti·ªÖn Vi·ªát Nam.</div>
        </div>
      </div>
      <div class="input-row">
        <textarea id="user-input" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n..."></textarea>
        <button id="send">G·ª≠i</button>
      </div>
    </div>
  </div>

<script>
const KNOWLEDGE_BASE = {
  "3.1": {
    title: "3.1 L√Ω lu·∫≠n c·ªßa C. M√°c v·ªÅ gi√° tr·ªã th·∫∑ng d∆∞",
    text: `
üîπ **Kh√°i ni·ªám:**
Gi√° tr·ªã th·∫∑ng d∆∞ (GTTD) l√† ph·∫ßn gi√° tr·ªã m·ªõi m√† ng∆∞·ªùi lao ƒë·ªông t·∫°o ra v∆∞·ª£t qu√° gi√° tr·ªã s·ª©c lao ƒë·ªông ‚Äì ph·∫ßn n√†y b·ªã nh√† t∆∞ b·∫£n chi·∫øm ƒëo·∫°t.

üîπ **C·∫•u tr√∫c gi√° tr·ªã h√†ng ho√°:**
W = c + v + m
- c: t∆∞ b·∫£n b·∫•t bi·∫øn (gi√° tr·ªã t∆∞ li·ªáu s·∫£n xu·∫•t)
- v: t∆∞ b·∫£n kh·∫£ bi·∫øn (gi√° tr·ªã s·ª©c lao ƒë·ªông)
- m: gi√° tr·ªã th·∫∑ng d∆∞ (lao ƒë·ªông kh√¥ng c√¥ng)

üîπ **Qu√° tr√¨nh s·∫£n xu·∫•t GTTD:**
Th·ªùi gian lao ƒë·ªông g·ªìm:
- t‚ÇÅ: th·ªùi gian t·∫•t y·∫øu (t·∫°o gi√° tr·ªã t∆∞∆°ng ƒë∆∞∆°ng ti·ªÅn l∆∞∆°ng)
- t‚ÇÇ: th·ªùi gian th·∫∑ng d∆∞ (t·∫°o gi√° tr·ªã th·∫∑ng d∆∞)
‚Üí m‚Äô = m / v √ó 100%

üîπ **B·∫£n ch·∫•t:**
GTTD kh√¥ng do t∆∞ b·∫£n sinh ra m√† do lao ƒë·ªông s·ªëng t·∫°o ra. Lao ƒë·ªông l√† h√†ng ho√° ƒë·∫∑c bi·ªát ‚Äì gi√° tr·ªã s·ª≠ d·ª•ng c·ªßa n√≥ t·∫°o ra gi√° tr·ªã m·ªõi l·ªõn h∆°n b·∫£n th√¢n n√≥.

üîπ **√ù nghƒ©a:**
N·ªÅn t·∫£ng h·ªçc thuy·∫øt kinh t·∫ø ch√≠nh tr·ªã M√°c; v·∫°ch tr·∫ßn b·∫£n ch·∫•t b√≥c l·ªôt "h·ª£p ph√°p" trong TBCN.
`
  },
  "3.1.3": {
    title: "3.1.3 C√°c ph∆∞∆°ng ph√°p s·∫£n xu·∫•t gi√° tr·ªã th·∫∑ng d∆∞",
    text: `
üîπ **1. Gi√° tr·ªã th·∫∑ng d∆∞ tuy·ªát ƒë·ªëi:**
TƒÉng b·∫±ng c√°ch k√©o d√†i ng√†y lao ƒë·ªông v∆∞·ª£t qu√° th·ªùi gian t·∫•t y·∫øu.
- Ng√†y lao ƒë·ªông = t‚ÇÅ + t‚ÇÇ
- V√≠ d·ª•: 8h ‚Üí 10h; t‚ÇÇ tƒÉng t·ª´ 4h ‚Üí 6h ‚Üí m‚Äô = 150%

üîπ **2. Gi√° tr·ªã th·∫∑ng d∆∞ t∆∞∆°ng ƒë·ªëi:**
Gi·∫£m th·ªùi gian t·∫•t y·∫øu t‚ÇÅ nh·ªù tƒÉng nƒÉng su·∫•t lao ƒë·ªông ‚Üí gi√° tr·ªã s·ª©c lao ƒë·ªông gi·∫£m.
- V√≠ d·ª•: t‚ÇÅ = 4h ‚Üí 3h ‚Üí m‚Äô = 166%

üîπ **3. Gi√° tr·ªã th·∫∑ng d∆∞ si√™u ng·∫°ch:**
Xu·∫•t hi·ªán khi gi√° tr·ªã c√° bi·ªát < gi√° tr·ªã x√£ h·ªôi.
- V√≠ d·ª•: h√†ng h√≥a c√≥ gi√° tr·ªã x√£ h·ªôi 100, DN ch·ªâ t·ªën 80 ‚Üí GTTD si√™u ng·∫°ch = 20

üîπ **√ù nghƒ©a:**
C√°c ph∆∞∆°ng ph√°p tr√™n cho th·∫•y b·∫£n ch·∫•t TBCN l√† kh√¥ng ng·ª´ng tƒÉng c∆∞·ªùng b√≥c l·ªôt ƒë·ªÉ t·ªëi ƒëa h√≥a l·ª£i nhu·∫≠n.
`
  },
  "3.2": {
    title: "3.2 T√≠ch l≈©y t∆∞ b·∫£n",
    text: `
üîπ **Kh√°i ni·ªám:**
L√† qu√° tr√¨nh chuy·ªÉn m·ªôt ph·∫ßn gi√° tr·ªã th·∫∑ng d∆∞ (m) th√†nh t∆∞ b·∫£n m·ªõi (ŒîC).
C√¥ng th·ª©c: ŒîC = m √ó a (v·ªõi a l√† t·ª∑ l·ªá t√°i ƒë·∫ßu t∆∞)

üîπ **H·ªá qu·∫£:**
- C·∫•u t·∫°o h·ªØu c∆° t∆∞ b·∫£n tƒÉng (c/v ‚Üë)
- T√≠ch t·ª• v√† t·∫≠p trung t∆∞ b·∫£n
- Ph√¢n ho√° giai c·∫•p: t∆∞ b·∫£n gia ‚Üí gi√†u, c√¥ng nh√¢n ‚Üí ngh√®o
- H√¨nh th√†nh "qu√¢n d·ª± b·ªã c√¥ng nghi·ªáp"

üîπ **√ù nghƒ©a:**
Ph·∫£n √°nh ƒë·ªông l·ª±c m·ªü r·ªông c·ªßa TBCN, ƒë·ªìng th·ªùi l√† nguy√™n nh√¢n c·ªßa b·∫•t b√¨nh ƒë·∫≥ng x√£ h·ªôi.
`
  },
  "3.3": {
    title: "3.3 C√°c h√¨nh th·ª©c bi·ªÉu hi·ªán c·ªßa gi√° tr·ªã th·∫∑ng d∆∞",
    text: `
üîπ **1. L·ª£i nhu·∫≠n (p):**
p = G ‚Äì k = m; p‚Äô = p / (c + v) √ó 100%

üîπ **2. L·ª£i t·ª©c (Z):**
Ph·∫ßn l·ª£i nhu·∫≠n b√¨nh qu√¢n tr·∫£ cho ng∆∞·ªùi cho vay v·ªën.
Z‚Äô = Z / (TBCV) √ó 100%

üîπ **3. ƒê·ªãa t√¥ t∆∞ b·∫£n ch·ªß nghƒ©a:**
- ƒê·ªãa t√¥ ch√™nh l·ªách I, II, ƒë·ªãa t√¥ tuy·ªát ƒë·ªëi.
- Ngu·ªìn g·ªëc: ph·∫ßn l·ª£i nhu·∫≠n si√™u ng·∫°ch t·ª´ ƒë·∫•t.

üîπ **Hi·ªán ƒë·∫°i:**
"Data rent", "Platform rent", "Algorithm rent" ‚Äì b√≥c l·ªôt b·∫±ng d·ªØ li·ªáu, n·ªÅn t·∫£ng, thu·∫≠t to√°n.
`
  },
  "vietnam": {
    title: "Th·ª±c ti·ªÖn t·∫°i Vi·ªát Nam",
    text: `
üîπ **1. GTTD trong FDI:**
C√¥ng nh√¢n Samsung, Foxconn l√†m 8h, t·∫°o gi√° tr·ªã g·∫•p 4‚Äì5 l·∫ßn l∆∞∆°ng nh·∫≠n ƒë∆∞·ª£c.

üîπ **2. T√≠ch l≈©y t∆∞ b·∫£n:**
70% l·ª£i nhu·∫≠n FDI t√°i ƒë·∫ßu t∆∞ ‚Üí tƒÉng t√≠ch l≈©y t∆∞ b·∫£n, song c≈©ng tƒÉng b·∫•t b√¨nh ƒë·∫≥ng.

üîπ **3. H√¨nh th·ª©c bi·ªÉu hi·ªán m·ªõi:**
L·ª£i nhu·∫≠n si√™u ng·∫°ch (FPT, VNG), "ƒë·ªãa t√¥ d·ªØ li·ªáu", b·∫•t ƒë·ªông s·∫£n, t√†i ch√≠nh.

üîπ **4. Gi·∫£i ph√°p:**
TƒÉng gi√° tr·ªã s·ª©c lao ƒë·ªông, ƒëi·ªÅu ti·∫øt qua thu·∫ø, h∆∞·ªõng t·ªõi kinh t·∫ø th·ªã tr∆∞·ªùng ƒë·ªãnh h∆∞·ªõng XHCN.
`
  }
};

function appendMessage(role, text) {
  const msg = document.createElement("div");
  msg.className = "msg " + role;
  const bubble = document.createElement("div");
  bubble.className = "bubble";
  bubble.innerHTML = text;
  msg.appendChild(bubble);
  document.getElementById("view").appendChild(msg);
  document.getElementById("view").scrollTop = 999999;
}

async function handleQuestion(q) {
  if (!q.trim()) return;
  appendMessage("user", q);
  document.getElementById("user-input").value = "";

  const lower = q.toLowerCase();
  const matched = Object.entries(KNOWLEDGE_BASE).find(([k, v]) => lower.includes(v.title.split(" ")[1].toLowerCase()));
  if (matched) {
    const [_, v] = matched;
    appendMessage("ai", `<strong>${v.title}</strong><br>${v.text.replace(/\n/g, "<br>")}`);
    return;
  }

  appendMessage("ai", "‚è≥ ƒêang ph√¢n t√≠ch s√¢u...");

  try {
    const res = await fetch("/api/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: q }),
    });
    const data = await res.json();
    appendMessage("ai", data.reply.replace(/\n/g, "<br>"));
  } catch (err) {
    appendMessage("ai", "‚ö†Ô∏è L·ªói khi g·ªçi API: " + err.message);
  }
}

// render topics
const topicsEl = document.getElementById("topics");
Object.values(KNOWLEDGE_BASE).forEach(v => {
  const el = document.createElement("div");
  el.className = "topic";
  el.innerHTML = `<strong>${v.title}</strong><br><span style="font-size:13px;color:#555;">${v.text.slice(0, 80)}...</span>`;
  el.onclick = () => appendMessage("ai", `<strong>${v.title}</strong><br>${v.text.replace(/\n/g, "<br>")}`);
  topicsEl.appendChild(el);
});

document.getElementById("send").addEventListener("click", () => handleQuestion(document.getElementById("user-input").value));
document.getElementById("user-input").addEventListener("keypress", e => {
  if (e.key === "Enter" && !e.shiftKey) {
    e.preventDefault();
    handleQuestion(e.target.value);
  }
});
</script>
</body>
</html>
